<!DOCTYPE html>
<html lang="en">
	<head>
		<meta http-equiv="content-type" content="text/html; charset=UTF-8">
		<meta charset="utf-8">
		<title>APKScanner Report</title>
		<meta name="generator" content="Bootply" />
		<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
		<link href="../../reporting/templates/dist/css/bootstrap.min.css" rel="stylesheet">
		<!--[if lt IE 9]>
			<script src="../../reporting/templates/dist/js/html5.js"></script>
		<![endif]-->

        <link rel="stylesheet" href="../../reporting/templates/dist/css/bootstrap.min.css">

        <link href="../../reporting/templates/dist/css/file-tree.min.css" rel="stylesheet">
        <link href="../../reporting/templates/dist/css/styles.css" rel="stylesheet">
    </head>
	<body>
<!-- Header -->

<!-- /Header -->

<!-- Main -->
<div class="container-fluid">
    <div class="row">
        <div class="col-md-7 col-md-offset-1">
        <div class="header clearfix">
        <h3 class="text-muted">{{ data["modules"]["info/app"]["run"]["results"]["package_name"] }}</h3>
            <hr>
      </div>
            </div>
    </div>


	 <div class="col-md-5 col-md-offset-1">
		<div class="panel panel-default">
                	<div class="panel-heading"><h4>Informations</h4></div>
                  	<div class="panel-body">
                	<p><strong>Name :</strong> {{ data["modules"]["info/app"]["run"]["results"]["name"] }} </p>
			<p><strong>Package :</strong> {{ data["modules"]["info/app"]["run"]["results"]["package_name"] }} </p>
			<p><strong>Description :</strong> {{ data["modules"]["info/app"]["run"]["results"]["description"] }}
			<p><strong>Platform: </strong> {{ data["modules"]["info/app"]["run"]["results"]["platform"]["version"] }} - {{ data["modules"]["info/app"]["run"]["results"]["platform"]["name"] }}  </p>
            <p><strong>Min SDK: </strong> {{ data["modules"]["info/app"]["run"]["results"]["min_sdk"] }}  </p>
			<p><strong>Target SDK: </strong> {{ data["modules"]["info/app"]["run"]["results"]["target_sdk"] }}  </p>
            <p><strong>Debuggable: </strong> {{  "<span class=\"label label-danger\">True</span>" if data["modules"]["info/debuggable"]["run"]["results"] else "<span class=\"label label-success\">False</span>" }} </p>
			<p><strong>Allow Backups: </strong> {{ data["modules"]["info/backup"]["run"]["results"]["allow_backup"] }} </p>
            <p><strong>Obfuscation: </strong> {{ data["modules"]["info/obfuscation"]["run"]["results"] }} </p>
            <p><strong>Libraries: </strong>
            <ul>
                        {% for library in data["modules"]["info/app"]["run"]["results"]["libraries"] %}
                            <li>{{ library }}</li>
                        {% endfor %}
            </ul>
            </p>
        </div>
	</div>
</div>
	 <div class="col-md-5">
		<div class="panel panel-default">
                	<div class="panel-heading"><h4>Hashes</h4></div>
                  	<div class="panel-body">
			<table class="table">
    			<thead>
			<tr><td>Type</td><td>Value</td></tr>
			</thead>
  			<tbody>
			<tr><td>SHA-256</td><td>{{ data["modules"]["info/app"]["run"]["results"]["hashes"]["sha256"] }}</td></tr>
			<tr><td>SHA-1</td><td>{{ data["modules"]["info/app"]["run"]["results"]["hashes"]["sha1"] }}</td></tr>
			<tr><td>MD5</td><td>{{ data["modules"]["info/app"]["run"]["results"]["hashes"]["md5"] }}</td></tr>
			</tbody>
			</table>

			</div>
		</div>
         <div class="panel panel-default">
                	<div class="panel-heading"><h4>Certificate</h4></div>
                  	<div class="panel-body">
			<p><strong>Subject :</strong> {{ data["modules"]["info/certificate"]["run"]["results"]["subject"] }} </p>
			<p><strong>Serial number :</strong> {{ data["modules"]["info/certificate"]["run"]["results"]["serial_number"] }} </p>
			<p><strong>Fingerprint :</strong> {{ data["modules"]["info/certificate"]["run"]["results"]["fingerprint"] }} </p>
			<p><strong>Issuer :</strong> {{ data["modules"]["info/certificate"]["run"]["results"]["issuer"] }} </p>
			<p><strong>Verified :</strong> {{ "<span class=\"label label-success\">True</span>" if data["modules"]["info/certificate"]["run"]["results"]["verified"] else "<span class=\"label label-danger\">False</span>" }} </p>
			<p><strong>Version :</strong>  {{ data["modules"]["info/certificate"]["run"]["results"]["version"] }}</p>
			<!-- <p{{ data["modules"]["info/certificate"]["run"]["results"]["text"].replace("\n", "<br />") }} </p> -->
			<p><strong>Public key</strong></p>
			<pre>{{ data["modules"]["info/certificate"]["run"]["results"]["pubkey"] }}</pre>
			</div>
	</div>
	</div>

    <div class="col-md-10 col-md-offset-1">

        <div class="panel panel-default">
			<div class="panel-heading"><h4>Permissions</h4></div>
            <table class="table table-bordered">
                <thead>
                <tr>
                    <th>NAME</th>
					<th>DESCRIPTION</th>
                    <th>LEVEL</th>
                </tr>
                </thead>
                <tbody>
                {% set labels = {"signatureOrSystem": "warning", "unknown": "default", "dangerous": "danger", "normal": "info"} %}
                {% for name in data["modules"]["permissions/granting"]["run"]["results"]["manifest_permissions"] %}
				    {% set label = "btn btn-%s" % labels[data["modules"]["permissions/granting"]["run"]["results"]["manifest_permissions"][name]["status"]] %}
                    <tr>
                        <td>{{ name }}</td>
                        <td>{{ data["modules"]["permissions/granting"]["run"]["results"]["manifest_permissions"][name]["description"] }}</td>
                        <td>
                            <div class="{{ label }}" style="width:100%;background-color:#777;border:none;color:white;">
                            {{data["modules"]["permissions/granting"]["run"]["results"]["manifest_permissions"][name]["status"] }}
                            </div>
                        </td>
                    </tr>
				{% endfor %}
				</tbody>
				</table>
			</div>
        </div>

    <div class="col-md-10 col-md-offset-1">
		<div class="panel panel-default">
			<div class="panel-heading"><h4>Dissassembled Code</h4></div>
            <div class="panel-body">
            <div class="row">
                <div class="col-sm-6 col-md-3">
                    <div class="thumbnail">
                        <a href="#">
                            <i class="glyphicon glyphicon-download" style="color:#555;margin-left:25%;margin-top:10px;font-size:100px;"></i>
                        </a>
                        <div class="caption">
                            <h3>Java</h3>
                            <p>Disassembled Java code</p>
                        </div>
                    </div>
                  </div>
                 <div class="col-sm-6 col-md-3">
                    <div class="thumbnail">
                        <a href="#">
                            <i class="glyphicon glyphicon-download" style="color:#555;margin-left:25%;margin-top:10px;font-size:100px;"></i>
                        </a>
                        <div class="caption">
                            <h3>Smali</h3>
                            <p>Disassembled Smali</p>
                        </div>
                    </div>
                  </div>

                 <div class="col-sm-6 col-md-3">
                    <div class="thumbnail">
                        <a href="../{{ data['modules']['info/app']['run']['results']['package_name'] }}/code/jar/classes.jar">
                            <i class="glyphicon glyphicon-download" style="color:#555;margin-left:25%;margin-top:10px;font-size:100px;"></i>
                        </a>
                        <div class="caption">
                            <h3>Jar</h3>
                            <p>Jar</p>
                        </div>
                    </div>
                  </div>
                <div class="col-sm-6 col-md-3">
                    <div class="thumbnail">
                        <a href="../{{ data['modules']['info/app']['run']['results']['package_name'] }}/code/orig/classes.dex">
                            <i class="glyphicon glyphicon-download" style="color:#555;margin-left:25%;margin-top:10px;font-size:100px;"></i>
                        </a>
                        <div class="caption">
                            <h3>DEX</h3>
                            <p>DEX</p>
                        </div>
                    </div>
                  </div>
                </div>
            </div>
		</div>
	</div>

	<div class="col-md-10 col-md-offset-1">
		<div class="panel panel-default">
			<div class="panel-heading"><h4>Native Code</h4></div>
            {% if data["modules"]["info/native"]["run"]["results"]|length %}
                 <table class="table-responsive table-bordered table-hover">
                <thead>
                <tr>
                    <th class="col-md-1" style="text-align:center;">NAME</th>
                    <th style="text-align:center;">PATH </th>
                    <th class="col-md-1" style="text-align:center;">ARCH </th>
					<th class="col-md-8" style="text-align:center;">DESCRIPTION</th>
                </tr>
                </thead>
                <tbody>
                {% for lib in data["modules"]["info/native"]["run"]["results"] %}
                    <tr>
                        <td><p style="text-align:center;">{{ lib["name"] }}</p></td>
                        <td>{{ lib["path"] }}</td>
                        <td><p style="text-align:center;">{{ lib["arch"] }}</p></td>
                        <td><p style="text-align:center;">{{ lib["info"] }}</p></td>
                    </tr>
                {% endfor %}
                </tbody>
                </table>
			{% else %}
            <div class="panel-body">
            <p> No native code found. </p>
            </div>

			{% endif %}
		</div>
	</div>
    </div>

    <div class="col-md-10 col-md-offset-1">
        <div class="panel panel-default">
            <div class="panel-heading">
                <h4>Network capture <a href="../{{ data['modules']['info/app']['run']['results']['package_name'] }}/network/capture.pcap" alt="download network capture"><button type="button" class="btn btn-default pull-right">Download</button></a></h4>
            </div>
        </div>
    </div>

    <div class="col-md-10 col-md-offset-1">
	    <div class="panel panel-default">
		    <div class="panel-heading"><h4>API Calls</h4></div>

            {% for api in data["modules"]["info/apis"]["run"]["results"] %}
            <h4 class="panel-heading">{{ api }}</h4>

                <table class="table">
	    			<thead>
                    <tr><td>Package</td><td>File</td></tr>
                    </thead>
                    <tbody>
                {% for package in data["modules"]["info/apis"]["run"]["results"][api] %}
                    {% for file in data["modules"]["info/apis"]["run"]["results"][api][package] %}
                    <tr>
                        <td>{{ package }}</td>
                        <td>
                            {{ file }} on lines
                            {% for entry in data["modules"]["info/apis"]["run"]["results"][api][package][file] %}
                                {{ entry['line'] }},
                            {% endfor %}
                        </td>
                    </tr>
                    {% endfor %}
                {% endfor %}
                    </tbody>
                    </table>
            {% endfor %}
        </div>
        </div>

        <div class="col-md-10 col-md-offset-1">
            <div class="panel panel-default">
                	<div class="panel-heading"><h4>System Services</h4></div>

                        {% if data["modules"]["info/system_services"]["run"]["results"]|length %}
                  <table class="table table-bordered table-hover table-striped">
                <thead>
                <tr>
                    <th>NAME</th>
                    <th>CALL</th>
                </tr>
                </thead>
                <tbody>
                {% for system_service in data["modules"]["info/system_services"]["run"]["results"] %}
                    <tr><td>{{ system_service }}</td><td>0</td></tr>
				{% endfor %}
				</tbody>
				</table>
			{% else %}
                <div class="panel-body">
			        <p> No service call found. </p>
                </div>
			{% endif %}


            </div></div>



	<div class="col-md-10 col-md-offset-1">
		<div class="panel panel-default">
                	<div class="panel-heading"><h4>Providers</h4></div>

			{% if data["modules"]["permissions/providers"]["run"]["results"]|length %}
			<div class="panel-group" id="accordion" role="tablist" aria-multiselectable="true">
			{% else %}
                <div class="panel-body">
			<p> No providers found. </p>
                    </div>
			{% endif %}

			{% for provider in data["modules"]["permissions/providers"]["run"]["results"] %}

				<div class="{{ "panel panel-default" if not provider["vulnerable"] else "panel panel-warning" }}">
				    <div class="panel-heading" role="tab" id="heading{{ provider["name"].replace(".", "") }}">
				      <h4 class="panel-title">
				        <a data-toggle="collapse" href="#collapse{{ provider["name"].replace(".", "") }}" aria-expanded="false" aria-controls="collapse{{ provider["name"].replace(".", "") }}">
				         {{ provider["name"] }}
				        </a>
				      </h4>
				    </div>
				    <div id="collapse{{ provider["name"].replace(".", "") }}" class="panel-collapse collapse" role="tabpanel" aria-labelledby="heading{{ provider["name"].replace(".", "") }}">
				      <div class="panel-body">
				<p><strong>Read permission :</strong> {{ provider["read_permission"] }} </p>
				<p><strong>Permissions :</strong> {{ provider["permission"] }} </p>
				<p><strong>Process :</strong> {{ provider["process"] }} </p>
				<p><strong>Exported :</strong> {{ provider["exported"] }} </p>
				<p><strong>Authorities :</strong> {{ provider["authorities"] }} </p>
				<p><strong>Label :</strong> {{ provider["label"] }} </p>
				<p><strong>Grant_uri_permissions :</strong> {{ provider["grant_uri_permissions"] }} </p>
				<p><strong>Name :</strong> {{ provider["name"] }} </p>
				<p><strong>Enabled :</strong> {{ provider["enabled"] }} </p>
				<p><strong>Write permission :</strong> {{ provider["write_permission"] }} </p>

			        <table class="table">
	    			<thead>
					<tr><td>URI</td></tr>
				</thead>
	  			<tbody>
				{% for uri in provider["uris"] %}
					<tr><td>{{ uri }}</td></tr>
				{% endfor %}

				</tbody>
				</table>
					    </div>
  			</div>
			</div>
			{% endfor %}
			{% if data["modules"]["permissions/providers"]["run"]["results"]|length %}
				</div>
			{% endif %}
	</div>
</div>


	<div class="col-md-10 col-md-offset-1">
		<div class="panel panel-default">
                	<div class="panel-heading"><h4>Services</h4></div>

			{% if data["modules"]["permissions/services"]["run"]["results"]|length %}
			<div class="panel-group" id="accordion" role="tablist" aria-multiselectable="true">
			{% else %}
                <div class="panel-body">
			<p> No services found. </p>
                    </div>
			{% endif %}

			{% for service in data["modules"]["permissions/services"]["run"]["results"] %}

				<div class="{{  "panel panel-info" if not service["vulnerable"] else "panel panel-warning" }}">
				    <div class="panel-heading" role="tab" id="heading{{ service["name"].replace(".", "") }}">
				      <h4 class="panel-title">
				        <a data-toggle="collapse" href="#collapse{{ service["name"].replace(".", "") }}" aria-expanded="false" aria-controls="collapse{{ service["name"].replace(".", "") }}">
				         {{ service["name"] }}
				        </a>
				      </h4>
				    </div>
				    <div id="collapse{{ service["name"].replace(".", "") }}" class="panel-collapse collapse" role="tabpanel" aria-labelledby="heading{{ service["name"].replace(".", "") }}">
				      <div class="panel-body">
				<p><strong>Process :</strong> {{ service["process"] }} </p>
				<p><strong>Label :</strong> {{ service["label"] }} </p>
				<p><strong>Enabled :</strong> {{ service["enabled"] }} </p>
				<p><strong>Isolated process :</strong> {{ service["isolated_process"] }} </p>
				<p><strong>Exported :</strong> {{ service["exported"] }} </p>
					  </div>
  			</div>
        </div>
			{% endfor %}
			{% if data["modules"]["permissions/services"]["run"]["results"]|length %}
				</div>
			{% endif %}
		</div>
	</div>


<div class="col-md-10 col-md-offset-1">
		<div class="panel panel-default">
                	<div class="panel-heading"><h4>Activities</h4></div>

			{% if data["modules"]["permissions/activities"]["run"]["results"]|length %}
			<div class="panel-group" id="accordion" role="tablist" aria-multiselectable="true">
			{% else %}
			    <div class="panel-body">
                    <p> No activities found. </p>
			    </div>
            {% endif %}

			{% for activity in data["modules"]["permissions/activities"]["run"]["results"] %}

				<div class="{{  "panel panel-info" if not activity["vulnerable"] else "panel panel-warning" }}">
				    <div class="panel-heading" role="tab" id="heading{{ activity["name"].replace(".", "") }}">
				      <h4 class="panel-title">
				        <a data-toggle="collapse" href="#collapse{{ activity["name"].replace(".", "") }}" aria-expanded="false" aria-controls="collapse{{ activity["name"].replace(".", "") }}">
				         {{ activity["name"] }}
				        </a>
				      </h4>
				    </div>
				    <div id="collapse{{ activity["name"].replace(".", "") }}" class="panel-collapse collapse" role="tabpanel" aria-labelledby="heading{{ activity["name"].replace(".", "") }}">
				      <div class="panel-body">

                      <div class="col-md-5">
                <p><strong>Exported :</strong> {{ activity["exported"] }} </p>
                <p><strong>Permission:</strong> {{ activity["permission"] }} </p>
				<p><strong>Intent filters :</strong> {{ activity["intent_filters"]|length }} </p>
</div><div class="col-md-5 pull-right">
                          {% if activity["screenshot"]|length %}
                          <img src={{ activity["screenshot"] }} />
                          {% endif %}
                          </div>

					  </div>
  			</div>

			</div>
			{% endfor %}
			{% if data["modules"]["permissions/activities"]["run"]["results"]|length %}
				</div>
			{% endif %}
		</div>
	</div>




<div class="col-md-10 col-md-offset-1">
		<div class="panel panel-default">
                	<div class="panel-heading"><h4>Brodcast Receivers</h4></div>

			{% if data["modules"]["permissions/broadcast_receivers"]["run"]["results"]|length %}
			<div class="panel-group" id="accordion" role="tablist" aria-multiselectable="true">
			{% else %}
                <div class="panel-body">
                    <p> No broadcast receivers found. </p>
			    </div>
			{% endif %}

			{% for broadcast_receiver in data["modules"]["permissions/broadcast_receivers"]["run"]["results"] %}

				<div class="{{  "panel panel-info" if not broadcast_receiver["vulnerable"] else "panel panel-warning" }}">
				    <div class="panel-heading" role="tab" id="heading{{ broadcast_receiver["name"].replace(".", "") }}">
				      <h4 class="panel-title">
				        <a data-toggle="collapse" href="#collapse{{ broadcast_receiver["name"].replace(".", "") }}" aria-expanded="true" aria-controls="collapse{{ broadcast_receiver["name"].replace(".", "") }}">
				         {{ broadcast_receiver["name"] }}
				        </a>
				      </h4>
				    </div>
				    <div id="collapse{{ broadcast_receiver["name"].replace(".", "") }}" class="panel-collapse collapse" role="tabpanel" aria-labelledby="heading{{ broadcast_receiver["name"].replace(".", "") }}">
				      <div class="panel-body">

                <p><strong>Process :</strong> {{ broadcast_receiver["process"] }} </p>
				<p><strong>Label :</strong> {{ broadcast_receiver["label"] }} </p>
				<p><strong>Enabled :</strong> {{ broadcast_receiver["enabled"] }} </p>
				<p><strong>Exported :</strong> {{ broadcast_receiver["exported"] }} </p>
                <p><strong>Permission:</strong> {{ broadcast_receiver["permission"] }} </p>
					  </div>
  			</div>
			</div>
			{% endfor %}
			{% if data["modules"]["permissions/broadcast_receivers"]["run"]["results"]|length %}
				</div>
			{% endif %}
		</div></div>

    <div class="col-md-10 col-md-offset-1">
		<div class="panel panel-default">
                	<div class="panel-heading"><h4>Logcat <input type="text" id="logcat_search" style="width:200px;" placeholder="Search" class="form-control pull-right" /></h4></div>
                    <textarea id="logcat_display" rows="20" style="padding:5px;border:none;width:100%;font-family:monospace; color:white;background-color:rgb(43, 43, 43);">{{ logcat }}</textarea>
                    <div id="logcat" style="visibility:hidden;overflow-y:hidden;overflow-x:hidden;height:0px;">{{ logcat }} </div>
            </div>
        </div>

    <div class="col-md-10 col-md-offset-1">
		<div class="panel panel-default">
                	<div class="panel-heading"><h4>Strings</h4></div>
                        <table class="table table-bordered">
                <thead>
                <tr>
                    <th>URLS</th>
                </tr>
                </thead>
                <tbody>
                {% for url in data["modules"]["info/strings"]["run"]["results"]["urls"] %}
                <tr><td>{{ url }}</td></tr>
                {% endfor %}
                </tbody>
                </table>
            <br /><br />
                <table class="table table-bordered">
                <thead>
                <tr>
                    <th>EMAILS</th>
                </tr>
                </thead>
                <tbody>
                            {% for email in data["modules"]["info/strings"]["run"]["results"]["emails"] %}
                <tr class="default"><td>{{ email }}</td></tr>
                            {% endfor %}
                        </tbody></table>
            </div>
        </div>

    <div class="col-md-10 col-md-offset-1">
		<div class="panel panel-default">
                	<div class="panel-heading"><h4>External storage</h4></div>
                  	<div class="panel-body">
                    <div id="external_storage"></div>
                    </div>
            </div>
        </div>

    <div class="col-md-10 col-md-offset-1">
		<div class="panel panel-default">
                	<div class="panel-heading"><h4>Internal Storage</h4></div>
                  	<div class="panel-body">
                        <div id="internal_storage"></div>
                    </div>
            </div>
        </div>

<div class="col-md-10 col-md-offset-1">
		<div class="panel panel-default">
                	<div class="panel-heading"><h4>Vulnerabilities</h4></div>
       <table class="table table-bordered">
                <thead>
                <tr>
                    <th>#</th>
                    <th class="col-md-3">NAME</th>
                    <th>DESCRIPTION</th>
					<th>SEVERITY</th>
                </tr>
                </thead>
                <tbody>
                      {% set labels = {0: "success", 1 : "info", 2: "warning", 3: "danger" } %}
                      {% set severity = {0: "INFO", 1: "LOW", 2: "MEDIUM", 3: "HIGH"} %}
        {% for vulnerability in vulnerabilities|sort(reverse=True, attribute='level') %}
            {% set label = "btn btn-%s" % labels[vulnerability["level"]] %}

        <tr class="default">
          <td>{{ loop.index }}</td>
          <td>{{ vulnerability["name"] }}</td>
          <td>{{ vulnerability["description"] }}
              <br /><br />
              <ul>
              {% for resource in vulnerability["resources"] %}
                <li>{{ resource["name"] }} {{ resource["file"]  }}</li>
              {% endfor %}
              </ul>
              {% if vulnerability["logs"] != None %}
                <pre>{{ vulnerability["logs"] }} </pre>
              {% endif %}
          </td>
          <td><div class="{{ label }}" style="width:100%">{{ severity[vulnerability["level"]] }}</span></td>
        </tr>
      {% endfor %}
      </tbody>
    </table>
        </div>
<!-- /Main -->

	<!-- script references -->
		<script src="../../reporting/templates/dist/js/jquery.min.js"></script>
        <script src="../../reporting/templates/dist/js/jquery-ui.min.js"></script>
        <script src="../../reporting/templates/dist/js/bootstrap.min.js"></script>
		<script src="../../reporting/templates/dist/js/bootstrap.min.js"></script>
		<script src="../../reporting/templates/dist/js/scripts.js"></script>
        <script src="../../reporting/templates/dist/js/file-tree.min.js"></script>
        <script src="../../reporting/templates/dist/js/nestedSortable.js"></script>

        <script type="text/javascript">
$(document).ready(function(){
    var internal_data = {{ internal_storage }};
    $('#internal_storage').fileTree({ data: internal_data });
    var external_data = {{ external_storage }};
    $('#external_storage').fileTree({ data: external_data });
    $('#logcat_search').on('keyup', function(evt) {
        var search = $('#logcat_search').val();
        if(search == "") {
            $('#logcat_display').html($('#logcat').html());
        }else{
            $('#logcat_display').html("");
            var logcat = $('#logcat').html().split('\n');
            logcat.forEach(function(line) {
                if(line.indexOf(search) > -1){
                    $('#logcat_display').append(line+"\n");
                }
            });
        }

    });
});
</script>
    </body>
</html>
